<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bedrock Ranked API - Enhanced Features Demo</title>
</head>
<body>
    <div class="container">
        <h1>üéÆ Bedrock Ranked API - Enhanced Features</h1>
        <p class="subtitle">Test all the new API endpoints with live data</p>
        
        <!-- Match History Section -->
        <div class="section">
            <h2>üéØ Match History</h2>
            <div class="endpoint">
                <div class="endpoint-header">
                    <div class="endpoint-url">/api/matches/{user_id}</div>
                    <span class="badge">NEW</span>
                </div>
                <div class="input-group">
                    <label>User ID:</label>
                    <input type="text" id="matchHistoryUserId" placeholder="Enter Discord user ID">
                </div>
                <div class="input-group">
                    <label>Page:</label>
                    <input type="number" id="matchHistoryPage" value="1" min="1">
                </div>
                <div class="input-group">
                    <label>Per Page:</label>
                    <select id="matchHistoryPerPage">
                        <option value="10">10</option>
                        <option value="25" selected>25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <button onclick="fetchMatchHistory()">Fetch Match History</button>
                <div id="matchHistoryResponse" class="response-container"></div>
            </div>
        </div>
        
        <!-- Bot Messages Section -->
        <div class="section">
            <h2>ü§ñ Bot Messages</h2>
            <div class="endpoint">
                <div class="endpoint-header">
                    <div class="endpoint-url">/api/bot-messages</div>
                    <span class="badge">NEW</span>
                </div>
                <div class="input-group">
                    <label>Limit:</label>
                    <select id="botMessagesLimit">
                        <option value="10">10</option>
                        <option value="25">25</option>
                        <option value="50" selected>50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Channel ID (optional):</label>
                    <input type="text" id="botMessagesChannelId" placeholder="Leave empty for all channels">
                </div>
                <button onclick="fetchBotMessages()">Fetch Bot Messages</button>
                <div id="botMessagesResponse" class="response-container"></div>
            </div>
        </div>
        
        <!-- Server Messages Section -->
        <div class="section">
            <h2>üí¨ Server Messages</h2>
            <div class="endpoint">
                <div class="endpoint-header">
                    <div class="endpoint-url">/api/server-messages</div>
                    <span class="badge">NEW</span>
                </div>
                <div class="input-group">
                    <label>Limit:</label>
                    <select id="serverMessagesLimit">
                        <option value="10">10</option>
                        <option value="25">25</option>
                        <option value="50" selected>50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Author ID (optional):</label>
                    <input type="text" id="serverMessagesAuthorId" placeholder="Filter by user">
                </div>
                <div class="input-group">
                    <label>Channel ID (optional):</label>
                    <input type="text" id="serverMessagesChannelId" placeholder="Filter by channel">
                </div>
                <button onclick="fetchServerMessages()">Fetch Server Messages</button>
                <div id="serverMessagesResponse" class="response-container"></div>
            </div>
        </div>
        
        <!-- Weekly Race Section -->
        <div class="section">
            <h2>üèÅ Weekly Race</h2>
            
            <div class="endpoint">
                <div class="endpoint-header">
                    <div class="endpoint-url">/api/weekly/status</div>
                    <span class="badge">NEW</span>
                </div>
                <button onclick="fetchWeeklyStatus()">Get Weekly Status</button>
                <div id="weeklyStatusResponse" class="response-container"></div>
            </div>
            
            <div class="endpoint">
                <div class="endpoint-header">
                    <div class="endpoint-url">/api/weekly/leaderboard</div>
                    <span class="badge">NEW</span>
                </div>
                <div class="input-group">
                    <label>Scope:</label>
                    <select id="weeklyLeaderboardScope">
                        <option value="weekly" selected>This Week</option>
                        <option value="alltime">All Time</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Limit:</label>
                    <select id="weeklyLeaderboardLimit">
                        <option value="10" selected>10</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                    </select>
                </div>
                <button onclick="fetchWeeklyLeaderboard()">Get Leaderboard</button>
                <div id="weeklyLeaderboardResponse" class="response-container"></div>
            </div>
            
            <div class="endpoint">
                <div class="endpoint-header">
                    <div class="endpoint-url">/api/weekly/submissions</div>
                    <span class="badge">NEW</span>
                </div>
                <div class="input-group">
                    <label>Week (optional):</label>
                    <input type="number" id="weeklySubmissionsWeek" placeholder="Leave empty for all weeks">
                </div>
                <div class="input-group">
                    <label>Verified Only:</label>
                    <select id="weeklySubmissionsVerified">
                        <option value="false">All</option>
                        <option value="true">Verified Only</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>User (optional):</label>
                    <input type="text" id="weeklySubmissionsUser" placeholder="Filter by username">
                </div>
                <button onclick="fetchWeeklySubmissions()">Get Submissions</button>
                <div id="weeklySubmissionsResponse" class="response-container"></div>
            </div>
        </div>
    </div>
    
    <script>
        const API_BASE = 'http://localhost:8196/api';
        
        function showLoading(elementId) {
            const el = document.getElementById(elementId);
            el.className = 'response-container show';
            el.innerHTML = '<div class="loading">Loading...</div>';
        }
        
        function showResponse(elementId, data, isError = false) {
            const el = document.getElementById(elementId);
            el.className = 'response-container show';
            
            const className = isError ? 'error' : 'success';
            const formatted = JSON.stringify(data, null, 2);
            
            el.innerHTML = `
                <div class="${className}">
                    ${isError ? '‚ùå Error' : '‚úÖ Success'}
                </div>
                <pre>${formatted}</pre>
            `;
        }
        
        async function fetchMatchHistory() {
            const userId = document.getElementById('matchHistoryUserId').value;
            if (!userId) {
                alert('Please enter a user ID');
                return;
            }
            
            const page = document.getElementById('matchHistoryPage').value;
            const perPage = document.getElementById('matchHistoryPerPage').value;
            
            showLoading('matchHistoryResponse');
            
            try {
                const response = await fetch(`${API_BASE}/matches/${userId}?page=${page}&per_page=${perPage}`);
                const data = await response.json();
                showResponse('matchHistoryResponse', data, !response.ok);
            } catch (error) {
                showResponse('matchHistoryResponse', { error: error.message }, true);
            }
        }
        
        async function fetchBotMessages() {
            const limit = document.getElementById('botMessagesLimit').value;
            const channelId = document.getElementById('botMessagesChannelId').value;
            
            let url = `${API_BASE}/bot-messages?limit=${limit}`;
            if (channelId) url += `&channel_id=${channelId}`;
            
            showLoading('botMessagesResponse');
            
            try {
                const response = await fetch(url);
                const data = await response.json();
                showResponse('botMessagesResponse', data, !response.ok);
            } catch (error) {
                showResponse('botMessagesResponse', { error: error.message }, true);
            }
        }
        
        async function fetchServerMessages() {
            const limit = document.getElementById('serverMessagesLimit').value;
            const authorId = document.getElementById('serverMessagesAuthorId').value;
            const channelId = document.getElementById('serverMessagesChannelId').value;
            
            let url = `${API_BASE}/server-messages?limit=${limit}`;
            if (authorId) url += `&author_id=${authorId}`;
            if (channelId) url += `&channel_id=${channelId}`;
            
            showLoading('serverMessagesResponse');
            
            try {
                const response = await fetch(url);
                const data = await response.json();
                showResponse('serverMessagesResponse', data, !response.ok);
            } catch (error) {
                showResponse('serverMessagesResponse', { error: error.message }, true);
            }
        }
        
        async function fetchWeeklyStatus() {
            showLoading('weeklyStatusResponse');
            
            try {
                const response = await fetch(`${API_BASE}/weekly/status`);
                const data = await response.json();
                showResponse('weeklyStatusResponse', data, !response.ok);
            } catch (error) {
                showResponse('weeklyStatusResponse', { error: error.message }, true);
            }
        }
        
        async function fetchWeeklyLeaderboard() {
            const scope = document.getElementById('weeklyLeaderboardScope').value;
            const limit = document.getElementById('weeklyLeaderboardLimit').value;
            
            showLoading('weeklyLeaderboardResponse');
            
            try {
                const response = await fetch(`${API_BASE}/weekly/leaderboard?scope=${scope}&limit=${limit}`);
                const data = await response.json();
                showResponse('weeklyLeaderboardResponse', data, !response.ok);
            } catch (error) {
                showResponse('weeklyLeaderboardResponse', { error: error.message }, true);
            }
        }
        
        async function fetchWeeklySubmissions() {
            const week = document.getElementById('weeklySubmissionsWeek').value;
            const verified = document.getElementById('weeklySubmissionsVerified').value;
            const user = document.getElementById('weeklySubmissionsUser').value;
            
            let url = `${API_BASE}/weekly/submissions?verified=${verified}`;
            if (week) url += `&week=${week}`;
            if (user) url += `&user=${encodeURIComponent(user)}`;
            
            showLoading('weeklySubmissionsResponse');
            
            try {
                const response = await fetch(url);
                const data = await response.json();
                showResponse('weeklySubmissionsResponse', data, !response.ok);
            } catch (error) {
                showResponse('weeklySubmissionsResponse', { error: error.message }, true);
            }
        }
    </script>
</body>
</html>